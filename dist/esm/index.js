import { join, resolve, dirname } from 'path';
import isNode from 'ethical-utility-is-node';
import { isRelative, isAbsolute, getRootPath } from 'ethical-utility-path';

export var getAppPrefix = function getAppPrefix(moduleName) {
    return '~';
};

export var isAppModule = function isAppModule(moduleName) {
    return moduleName.charAt(0) === getAppPrefix();
};

export var isPackage = function isPackage(name) {
    if (isRelative(name) || isAbsolute(name)) return false;
    return true;
};

export var isAbsolutePackage = function isAbsolutePackage(name) {
    if (isPackage(name) && name.indexOf('/') === -1) return true;
    return false;
};

export var isRelativePackage = function isRelativePackage(name) {
    if (name.indexOf('/') > -1 && isPackage(name)) return true;
    return false;
};

export var appendExtension = function appendExtension(name) {
    var extension = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'js';

    if (isAbsolutePackage(name)) return name;
    var ext = '.' + extension;
    if (name.slice(-ext.length) === ext) return name;
    return name + ext;
};

export var getRequire = function getRequire() {
    if (isNode()) return require;
    return window.require;
};

export var resolveModuleName = function resolveModuleName(module) {
    if (isAppModule(module)) {
        return join(getRootPath(), module.replace(getAppPrefix(), ''));
    }
    if (isRelative(module)) return join(getRootPath(), module);
    return module;
};

export var requireModule = function requireModule(name) {
    var path = isNode() ? resolveModuleName(name) : name;
    return getRequire()(path);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVua25vd24iXSwibmFtZXMiOlsiam9pbiIsInJlc29sdmUiLCJkaXJuYW1lIiwiaXNOb2RlIiwiaXNSZWxhdGl2ZSIsImlzQWJzb2x1dGUiLCJnZXRSb290UGF0aCIsImdldEFwcFByZWZpeCIsIm1vZHVsZU5hbWUiLCJpc0FwcE1vZHVsZSIsImNoYXJBdCIsImlzUGFja2FnZSIsIm5hbWUiLCJpc0Fic29sdXRlUGFja2FnZSIsImluZGV4T2YiLCJpc1JlbGF0aXZlUGFja2FnZSIsImFwcGVuZEV4dGVuc2lvbiIsImV4dGVuc2lvbiIsImV4dCIsInNsaWNlIiwibGVuZ3RoIiwiZ2V0UmVxdWlyZSIsInJlcXVpcmUiLCJ3aW5kb3ciLCJyZXNvbHZlTW9kdWxlTmFtZSIsIm1vZHVsZSIsInJlcGxhY2UiLCJyZXF1aXJlTW9kdWxlIiwicGF0aCJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxPQUF4QixRQUF1QyxNQUF2QztBQUNBLE9BQU9DLE1BQVAsTUFBbUIseUJBQW5CO0FBQ0EsU0FBU0MsVUFBVCxFQUFxQkMsVUFBckIsRUFBaUNDLFdBQWpDLFFBQW9ELHNCQUFwRDs7QUFFQSxPQUFPLElBQU1DLGVBQWUsU0FBZkEsWUFBZSxDQUFDQyxVQUFEO0FBQUEsV0FBZ0IsR0FBaEI7QUFBQSxDQUFyQjs7QUFFUCxPQUFPLElBQU1DLGNBQWMsU0FBZEEsV0FBYyxDQUFDRCxVQUFEO0FBQUEsV0FDdkJBLFdBQVdFLE1BQVgsQ0FBa0IsQ0FBbEIsTUFBeUJILGNBREY7QUFBQSxDQUFwQjs7QUFJUCxPQUFPLElBQU1JLFlBQVksU0FBWkEsU0FBWSxDQUFDQyxJQUFELEVBQVU7QUFDL0IsUUFBSVIsV0FBV1EsSUFBWCxLQUFvQlAsV0FBV08sSUFBWCxDQUF4QixFQUEwQyxPQUFPLEtBQVA7QUFDMUMsV0FBTyxJQUFQO0FBQ0gsQ0FITTs7QUFLUCxPQUFPLElBQU1DLG9CQUFvQixTQUFwQkEsaUJBQW9CLENBQUNELElBQUQsRUFBVTtBQUN2QyxRQUFJRCxVQUFVQyxJQUFWLEtBQW1CQSxLQUFLRSxPQUFMLENBQWEsR0FBYixNQUFzQixDQUFDLENBQTlDLEVBQ0ksT0FBTyxJQUFQO0FBQ0osV0FBTyxLQUFQO0FBQ0gsQ0FKTTs7QUFNUCxPQUFPLElBQU1DLG9CQUFvQixTQUFwQkEsaUJBQW9CLENBQUNILElBQUQsRUFBVTtBQUN2QyxRQUFJQSxLQUFLRSxPQUFMLENBQWEsR0FBYixJQUFvQixDQUFDLENBQXJCLElBQTBCSCxVQUFVQyxJQUFWLENBQTlCLEVBQStDLE9BQU8sSUFBUDtBQUMvQyxXQUFPLEtBQVA7QUFDSCxDQUhNOztBQUtQLE9BQU8sSUFBTUksa0JBQWtCLFNBQWxCQSxlQUFrQixDQUFDSixJQUFELEVBQTRCO0FBQUEsUUFBckJLLFNBQXFCLHVFQUFULElBQVM7O0FBQ3ZELFFBQUlKLGtCQUFrQkQsSUFBbEIsQ0FBSixFQUE2QixPQUFPQSxJQUFQO0FBQzdCLFFBQU1NLE1BQU0sTUFBTUQsU0FBbEI7QUFDQSxRQUFJTCxLQUFLTyxLQUFMLENBQVcsQ0FBRUQsSUFBSUUsTUFBakIsTUFBOEJGLEdBQWxDLEVBQXVDLE9BQU9OLElBQVA7QUFDdkMsV0FBT0EsT0FBT00sR0FBZDtBQUNILENBTE07O0FBT1AsT0FBTyxJQUFNRyxhQUFhLFNBQWJBLFVBQWEsR0FBTTtBQUM1QixRQUFJbEIsUUFBSixFQUFjLE9BQU9tQixPQUFQO0FBQ2QsV0FBT0MsT0FBT0QsT0FBZDtBQUNILENBSE07O0FBS1AsT0FBTyxJQUFNRSxvQkFBb0IsU0FBcEJBLGlCQUFvQixDQUFDQyxNQUFELEVBQVk7QUFDekMsUUFBSWhCLFlBQVlnQixNQUFaLENBQUosRUFBeUI7QUFDckIsZUFBT3pCLEtBQUtNLGFBQUwsRUFBb0JtQixPQUFPQyxPQUFQLENBQWVuQixjQUFmLEVBQStCLEVBQS9CLENBQXBCLENBQVA7QUFDSDtBQUNELFFBQUlILFdBQVdxQixNQUFYLENBQUosRUFBd0IsT0FBT3pCLEtBQUtNLGFBQUwsRUFBb0JtQixNQUFwQixDQUFQO0FBQ3hCLFdBQU9BLE1BQVA7QUFDSCxDQU5NOztBQVFQLE9BQU8sSUFBTUUsZ0JBQWdCLFNBQWhCQSxhQUFnQixDQUFDZixJQUFELEVBQVU7QUFDbkMsUUFBTWdCLE9BQVN6QixXQUFXcUIsa0JBQWtCWixJQUFsQixDQUFYLEdBQXFDQSxJQUFwRDtBQUNBLFdBQU9TLGFBQWFPLElBQWIsQ0FBUDtBQUNILENBSE0iLCJmaWxlIjoidW5rbm93biIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpvaW4sIHJlc29sdmUsIGRpcm5hbWUgfSBmcm9tICdwYXRoJ1xuaW1wb3J0IGlzTm9kZSBmcm9tICdldGhpY2FsLXV0aWxpdHktaXMtbm9kZSdcbmltcG9ydCB7IGlzUmVsYXRpdmUsIGlzQWJzb2x1dGUsIGdldFJvb3RQYXRoIH0gZnJvbSAnZXRoaWNhbC11dGlsaXR5LXBhdGgnXG5cbmV4cG9ydCBjb25zdCBnZXRBcHBQcmVmaXggPSAobW9kdWxlTmFtZSkgPT4gJ34nXG5cbmV4cG9ydCBjb25zdCBpc0FwcE1vZHVsZSA9IChtb2R1bGVOYW1lKSA9PiAoXG4gICAgbW9kdWxlTmFtZS5jaGFyQXQoMCkgPT09IGdldEFwcFByZWZpeCgpXG4pXG5cbmV4cG9ydCBjb25zdCBpc1BhY2thZ2UgPSAobmFtZSkgPT4ge1xuICAgIGlmIChpc1JlbGF0aXZlKG5hbWUpIHx8IGlzQWJzb2x1dGUobmFtZSkpIHJldHVybiBmYWxzZVxuICAgIHJldHVybiB0cnVlXG59XG5cbmV4cG9ydCBjb25zdCBpc0Fic29sdXRlUGFja2FnZSA9IChuYW1lKSA9PiB7XG4gICAgaWYgKGlzUGFja2FnZShuYW1lKSAmJiBuYW1lLmluZGV4T2YoJy8nKSA9PT0gLTEpXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBjb25zdCBpc1JlbGF0aXZlUGFja2FnZSA9IChuYW1lKSA9PiB7XG4gICAgaWYgKG5hbWUuaW5kZXhPZignLycpID4gLTEgJiYgaXNQYWNrYWdlKG5hbWUpKSByZXR1cm4gdHJ1ZVxuICAgIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgY29uc3QgYXBwZW5kRXh0ZW5zaW9uID0gKG5hbWUsIGV4dGVuc2lvbiA9ICdqcycpID0+IHtcbiAgICBpZiAoaXNBYnNvbHV0ZVBhY2thZ2UobmFtZSkpIHJldHVybiBuYW1lXG4gICAgY29uc3QgZXh0ID0gJy4nICsgZXh0ZW5zaW9uXG4gICAgaWYgKG5hbWUuc2xpY2UoLShleHQubGVuZ3RoKSkgPT09IGV4dCkgcmV0dXJuIG5hbWVcbiAgICByZXR1cm4gbmFtZSArIGV4dFxufVxuXG5leHBvcnQgY29uc3QgZ2V0UmVxdWlyZSA9ICgpID0+IHtcbiAgICBpZiAoaXNOb2RlKCkpIHJldHVybiByZXF1aXJlXG4gICAgcmV0dXJuIHdpbmRvdy5yZXF1aXJlXG59XG5cbmV4cG9ydCBjb25zdCByZXNvbHZlTW9kdWxlTmFtZSA9IChtb2R1bGUpID0+IHtcbiAgICBpZiAoaXNBcHBNb2R1bGUobW9kdWxlKSkge1xuICAgICAgICByZXR1cm4gam9pbihnZXRSb290UGF0aCgpLCBtb2R1bGUucmVwbGFjZShnZXRBcHBQcmVmaXgoKSwgJycpKVxuICAgIH1cbiAgICBpZiAoaXNSZWxhdGl2ZShtb2R1bGUpKSByZXR1cm4gam9pbihnZXRSb290UGF0aCgpLCBtb2R1bGUpXG4gICAgcmV0dXJuIG1vZHVsZVxufVxuXG5leHBvcnQgY29uc3QgcmVxdWlyZU1vZHVsZSA9IChuYW1lKSA9PiB7XG4gICAgY29uc3QgcGF0aCA9ICggaXNOb2RlKCkgPyByZXNvbHZlTW9kdWxlTmFtZShuYW1lKSA6IG5hbWUgKVxuICAgIHJldHVybiBnZXRSZXF1aXJlKCkocGF0aClcbn1cbiJdfQ==